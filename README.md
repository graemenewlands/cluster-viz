# cluster-viz
templates and tooling for image rendering of ring based clusters

## motivation

automation for the creation of diagrams such as [this](src/dot/example.pdf).

## usage

A single ring can be drawn by editing the `src/ps/Cluster.ps` file. Parameters to the Cluster method allow node numbers, number of nodes and replication factor to be set.

Once a ring is described, `graphviz` can be used to render graphs.

## creating a ps file for dot

There is some work to improve this:

1. The `ps2eps` script won't work with libraries rendered with the run command, so the first step is to collapse the library into a single file:

ghostscript command:

    ghostscript -sOutputFile=RenderedCluster.ps -sDEVICE=ps2write Cluster.ps

2. The second step is to obtain the bounding box:

run ps2eps:

    ps2eps Rendered.ps

this command yields the BoundingBox:

    Input files: Rendered.ps
    Processing: Rendered.ps
    Rendering with existing %%BoundingBox: 0 0 595 842
    Calculating Bounding Box...ready. %%BoundingBox: 121 121 279 279
    Creating output file Rendered.eps ... ready.

3. now, edit `Rendered.ps` and place the `%%BoundingBox: 121 121 279 279` comment anywhere within the Rendered ps file

*Note: that `Rendered.ps` already has a BoundingBox because it was generated by `ps2write`. We can just replace it.*

4. Move the Rendered.ps file to the directory you want to maintain your templates.

5. Now you can create a simple dot file:

dot file:

    digraph G {
        DC1[image="Rendered.ps", label="DC1"];
        DC2[image="Rendered.ps", label="DC2"];
        DC3[image="Rendered.ps", label="DC3"];
        DC1->DC2;
        DC1->DC3;
        DC2->DC3;
        DC3->DC1;
    }

6. Render the dot file using:

Now render the graph:

    dot -Tps G.dot > G.ps
    ps2pdf G.ps

This will create a G.pdf

## Addendum

You may want to output the result as a `png` file, this can be done using:

    ghostscript -sOutputFile=outputFile.png -sDEVICE=pnggray G.ps